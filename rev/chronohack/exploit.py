import random
import time
from pwn import *

def get_random(length, seed):
    alphabet = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"
    random.seed(seed)
    s = ""
    for i in range(length):
        s += random.choice(alphabet)
    return s

if __name__ == "__main__":
    for offset in range(-500, 500, 50):
        conn = remote("verbal-sleep.picoctf.net", port=53191)
        seed = int(time.time() * 1000) + offset
        for i in range(-26, 26):
            print(conn.recvline("Enter your guess for the token (or exit):").decode())
            test_seed = seed + i
            token = get_random(20, test_seed)
            conn.sendline(token)
            if not conn.recvline("Sorry, your token does not match. Try again!", timeout=1.0):
                print(conn.recvall(timeout=1.0))
                exit()
        conn.close()

# picoCTF{UseSecure#$_Random@j3n3r@T0rs75f9fad7}
